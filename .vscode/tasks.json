{
  "version": "2.0.0",
  "_comment": "Tasks for HUMAN use only. Agents use terminal commands directly.",
  "options": {
    "shell": {
      "executable": "powershell.exe",
      "args": ["-NoProfile", "-Command"]
    }
  },
  "presentation": {
    "echo": true,
    "reveal": "silent",
    "focus": false,
    "panel": "shared",
    "showReuseMessage": false,
    "close": true
  },
  "tasks": [
    {
      "label": "Dev: Start server",
      "type": "shell",
      "command": "pnpm dev",
      "group": "build",
      "isBackground": true,
      "problemMatcher": []
    },
    {
      "label": "Build: Full build",
      "type": "shell",
      "command": "pnpm build",
      "group": "build",
      "problemMatcher": ["$tsc"]
    },
    {
      "label": "Check: TypeScript",
      "type": "shell",
      "command": "pnpm check",
      "group": "test",
      "problemMatcher": ["$tsc"]
    },
    {
      "label": "Test: Unit tests",
      "type": "shell",
      "command": "pnpm test",
      "group": "test",
      "problemMatcher": []
    },
    {
      "label": "Test: E2E smoke",
      "type": "shell",
      "command": "pnpm e2e",
      "group": "test",
      "problemMatcher": []
    },
    {
      "label": "Format: Prettier",
      "type": "shell",
      "command": "pnpm format",
      "problemMatcher": []
    },
    {
      "label": "DB: Push schema",
      "type": "shell",
      "command": "pnpm db:push:yes",
      "problemMatcher": []
    },
    {
      "label": "DB: Reset database",
      "type": "shell",
      "command": "pnpm db:reset",
      "problemMatcher": []
    },
    {
      "label": "Railway: View logs (100 lines)",
      "type": "shell",
      "command": "railway logs --limit 100",
      "problemMatcher": []
    },
    {
      "label": "Railway: Stream logs (live)",
      "type": "shell",
      "command": "railway logs --follow",
      "isBackground": true,
      "problemMatcher": []
    },
    {
      "label": "Railway: Search logs for errors",
      "type": "shell",
      "command": "railway logs --limit 200 | Select-String -Pattern 'error|Error|ERROR|failed|Failed|exception|Exception'",
      "problemMatcher": []
    },
    {
      "label": "Git: Status",
      "type": "shell",
      "command": "git status -sb",
      "problemMatcher": []
    },
    {
      "label": "Git: Hard reset to staging",
      "type": "shell",
      "command": "git fetch --prune origin; git checkout -f staging; git reset --hard origin/staging; git clean -fd; git status -sb",
      "problemMatcher": []
    },
    {
      "label": "GH: PR status (by number)",
      "type": "shell",
      "command": "gh pr view ${input:prNumber} --json url,state,isDraft,title,baseRefName,headRefName,mergeable,mergeStateStatus",
      "problemMatcher": []
    },
    {
      "label": "GH: Merge PR (squash)",
      "type": "shell",
      "command": "gh pr merge ${input:prNumber} --squash --delete-branch",
      "problemMatcher": []
    },
    {
      "label": "AEOS: Full status",
      "type": "shell",
      "command": ".\\scripts\\aeos-status.ps1",
      "problemMatcher": [],
      "detail": "Show AEOS state: heartbeat, assignment, worktrees, PRs, rate limits"
    },
    {
      "label": "Agent: Health check",
      "type": "shell",
      "command": "Write-Host '=== Agent Health Check ==='; Write-Host ''; Write-Host '[Git]' -ForegroundColor Cyan; git status -sb 2>&1 | Out-Null; if ($LASTEXITCODE -eq 0) { Write-Host '  git: PASS' } else { Write-Host '  git: FAIL' -ForegroundColor Red }; Write-Host '[GitHub CLI]' -ForegroundColor Cyan; gh auth status 2>&1 | Out-Null; if ($LASTEXITCODE -eq 0) { Write-Host '  gh auth: PASS' } else { Write-Host '  gh auth: FAIL' -ForegroundColor Red }; Write-Host '[Node]' -ForegroundColor Cyan; Write-Host ('  node: ' + (node --version)); Write-Host ('  pnpm: ' + (pnpm --version)); Write-Host '=== Done ===' -ForegroundColor Green",
      "problemMatcher": []
    },
    {
      "label": "Agent: Cleanup stale branches",
      "type": "shell",
      "command": ".\\scripts\\cleanup-agent-branches.ps1",
      "problemMatcher": [],
      "detail": "Delete merged agent branches and prune stale worktrees"
    },
    {
      "label": "Utility: Keep awake",
      "type": "shell",
      "command": ".\\scripts\\keep-awake-while-vscode.ps1",
      "isBackground": true,
      "problemMatcher": [],
      "detail": "Prevents Windows sleep while VS Code is running"
    }
  ],
  "inputs": [
    {
      "id": "prNumber",
      "type": "promptString",
      "description": "PR number"
    }
  ]
}
